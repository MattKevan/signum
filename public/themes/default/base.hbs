{{! themes/default/base.hbs }}
<!DOCTYPE html>
<html lang="en">
<head>
    {{!-- The head partial now receives its own scoped context --}}
    {{> head headContext}}
</head>
<body class="sans-serif">
    <div x-data="{ isMobileMenuOpen: false }" class="flex flex-column min-vh-100">
        {{> header}}
        <main class="flex-auto mw8 center pa3 pa4-ns">
            {{!-- 
              --- FIX: Use the new async render_layout helper ---
              This helper will render the layout specified by `pageLayoutName`
              using the data from `pageContext`, and it will correctly `await`
              any async helpers (like `{{{image}}}`) used inside it.
            --}}
            {{{render_layout pageLayoutName pageContext}}}
        </main>
        {{> footer}}
    </div>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</body>
</html>